(window.webpackJsonp=window.webpackJsonp||[]).push([[1,0],{1151:function(e,t,a){"use strict";a.d(t,"c",(function(){return o})),a.d(t,"a",(function(){return n})),a.d(t,"b",(function(){return i}));var n={ONLY_SHOW:"ONLY_SHOW"},r=[1,2],c={1:{type:"invalid",text:"已失效"},2:{type:"audit",text:"审核中"}},o=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.validStatus;return r.includes(t)},i=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.validStatus,a=c[t];return a}},1193:function(e,t,a){var n=a(34);e.exports=function(e,t){if(null==e)return{};var a,r,c=n(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)a=o[r],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(c[a]=e[a])}return c},e.exports.default=e.exports,e.exports.__esModule=!0},1194:function(e,t,a){"use strict";a.r(t),a.d(t,"PLUGIN_CARD_TYPE",(function(){return H})),a.d(t,"PLUGIN_DISPLAY_MODE",(function(){return et})),a.d(t,"PLUGIN_CARD_STYLE",(function(){return Ke})),a.d(t,"ECOMMERCE_SOURCE_FROM",(function(){return X})),a.d(t,"default",(function(){return nt}));var n=a(36),r=a.n(n),c=a(21),o=a.n(c),i=a(23),s=a.n(i),l=a(29),d=a.n(l),u=a(16),m=a.n(u),p=a(25),f=a.n(p),v=a(1),h=a.n(v),C=a(196),E=a.n(C),g=a(44),k=a.n(g),y=a(67),b=a(49),w=a.n(b),N=a(116),T=a.n(N),O=a(102);function _(e){var t=e.url,a=e.downloadUrl,n=e.cardType,r=e.os,c=e.parentType,o=e.urlToken,i=e.zhiContentInfo,s=(i=void 0===i?{}:i).cid,l=t.replace("__CREATIVEID__",Object(y.f)()||s);return"download"===n&&"ios"===r&&a?a:"message"===n?Object(y.a)(l,{source_type:c,source_id:o}):l}function S(e,t){if(e){var a=t?e:Object(O.removeBIZParameter)(e),n=document.createElement("a");n.href=a,"ios"===Object(y.h)().os&&t||(n.target="_blank"),n.rel="noopener noreferrer",n.click()}}function x(e){return L.apply(this,arguments)}function L(){return(L=T()(w.a.mark((function e(t){return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",new Promise((function(e){if(t){var a=null,n=document.createElement("iframe");n.src=t,n.style.display="none",document.body.appendChild(n),a=setTimeout((function(){clearTimeout(a),e({status:!1})}),2e3),document.addEventListener("visibilitychange",(function(){(document.hidden||document.webkitHidden)&&(clearTimeout(a),e({status:!0}))}))}})));case 1:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var D=function(e){return fetch("https://www.zhihu.com/api/v4/commercial/wechat/miniapp/scheme?url=".concat(e),{method:"GET"}).then((function(e){return e.status>=400?null:e.json()})).catch((function(e){console.error(e)}))},I=a(31),P=a.n(I),R=a(47),j=a.n(R);function U(e){return h.a.createElement("svg",r()({xmlns:"http://www.w3.org/2000/svg",width:"83",height:"83",viewBox:"0 0 83 83"},e),h.a.createElement("g",{fill:"none",fillRule:"evenodd"},h.a.createElement("circle",{cx:"41.5",cy:"41.5",r:"41.5",fill:"#0084FF"}),h.a.createElement("path",{fill:"#FFF",fillRule:"nonzero",d:"M22.4748737,38.5176187 C21.1080387,37.1507837 18.8919613,37.1507837 17.5251263,38.5176187 C16.1582912,39.8844537 16.1582912,42.1005311 17.5251263,43.4673662 L32.5251263,58.4673662 C33.8919613,59.8342012 36.1080387,59.8342012 37.4748737,58.4673662 L65.4673662,30.4748737 C66.8342012,29.1080387 66.8342012,26.8919613 65.4673662,25.5251263 C64.1005311,24.1582912 61.8844537,24.1582912 60.5176187,25.5251263 L35,51.042745 L22.4748737,38.5176187 Z"})))}function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onCancel,a=e.data,n=void 0===a?{}:a,r=Object(v.useState)("open"),c=P()(r,2),o=c[0],i=c[1];function s(){var e=n.wechat,a=n.shareUrl,r=e;"wechat_share"!==n.cardType||e||(r=a),Object(y.c)(r);try{var c,o=document.createElement("iframe");o.src="weixin://",o.style.display="none",document.body.appendChild(o),c=setTimeout((function(){i("copy")}),2e3),document.addEventListener("visibilitychange",(function(){(document.hidden||document.webkitHidden)&&(clearTimeout(c),t())}))}catch(e){console.log(e)}}var l=function(){var e=n.cardType,a=void 0===e?"":e,r=n.wechat,c=!0,i="微信号已复制";return"wechat_share"===a&&((void 0===r?"":r)?i="公众号已复制":(c=!1,i="公众号链接已复制")),"open"===o?h.a.createElement(h.a.Fragment,null,h.a.createElement(U,{style:{height:"40px"}}),h.a.createElement("div",{className:"WechatModal-copy"},i),h.a.createElement("div",{className:"WechatModal-des"},"立即打开微信分享好友关注"),h.a.createElement("div",{className:"WechatModal-buttons"},h.a.createElement("div",{className:"WechatModal-button",onClick:t},"取消"),h.a.createElement("div",{className:"WechatModal-button active",onClick:s},"打开"))):h.a.createElement(h.a.Fragment,null,h.a.createElement("div",{className:"WechatModal-copy"},i),h.a.createElement("div",null,"也可按照以下步骤完成关注"),h.a.createElement("div",{className:"WechatModal-ol"},h.a.createElement("div",null,"1、打开微信",c?"":",在任意会话窗口复制链接"),h.a.createElement("div",null,"2、添加关注")),h.a.createElement("div",{className:"WechatModal-button close",onClick:t},"关闭"))},d=function(){var e=n.qrCode;return h.a.createElement("div",{onClick:t,className:"WechatModal-imgContent"},h.a.createElement("img",{src:e,className:""}),h.a.createElement("span",null,"请长按识别或微信扫一扫预览"))};function u(){var e=n.cardType;switch(void 0===e?"":e){case"wechat":case"wechat_share":return l();case"wechat_service":return d();default:return null}}return h.a.createElement("div",{className:"WechatModal"},h.a.createElement("div",{className:"WechatModal-mask"}),h.a.createElement("div",{className:"WechatModal-content"},h.a.createElement("div",{className:"WechatModal-text"},u())))}A.show=function(e){var t=document.createElement("div");document.body.appendChild(t);j.a.render(h.a.createElement(A,{onCancel:function(){setTimeout((function(){j.a.unmountComponentAtNode(t),document.body.removeChild(t)}))},data:e}),t)};var M={wechat:function(e){var t=e.packageName,a=e.isZmHandle,n=e.wechat,r=e.conversion;if(a)return A.show(e),Promise.resolve({status:!0});return F({type:O.HYBRID_ACTION_EVENT.adOpenWechat,payload:{deeplink:"weixin://",packageName:t,wechatId:n,conversion:r}})},wechat_share:function(e){return z.apply(this,arguments)},wechat_minipro:V,wechat_service:function(e){var t=e.appid,a=void 0===t?"wx1abcffe23814c5ea":t,n=e.scene,r=void 0===n?"0":n,c=e.templateId,o=void 0===c?"lpmljOmEI0FyLCcDosc5cxArV1LHDYKIqX6Mk4RbAmI":c,i=e.id,s=e.si,l=e.url,d=e.conversion;if(e.isZmHandle)return A.show(e),Promise.resolve({status:!0});return F({type:O.HYBRID_ACTION_EVENT.adWxPushOnceMsgAuth,payload:{appid:a,scene:r,template_id:o,pluginId:i,conversion:d,si:s,url:l}})},message:function(e){var t=e.parentType,a=e.urlToken,n=e.hashId;return F({type:O.HYBRID_ACTION_EVENT.baseOpenInbox,payload:{inbox_id:n,initial_message:"",auto_focus:!0,title:"",source_type:t,source_id:a}})},download:function(e){return V(e).then((function(t){return t.status?t:function(e){var t=e.downloadUrl,a=e.downloadConversion,n=void 0===a?[]:a,r=e.productName,c=e.picUrl,o=e.isZmHandle;if(!t)return Promise.resolve({status:!1});if(o&&"android"===Object(y.h)().os)return S(t),Promise.resolve({status:!0});if("ios"===Object(y.h)().os)return Z({url:_(e)});return F({type:O.HYBRID_ACTION_EVENT.adDownloadApk,payload:{adjson:JSON.stringify({ads:[{conversion_tracks:n,creatives:[{asset:{brand_name:r,app_promotion_url:t,brand_logo:c}}]}]})}})}(e)}))},normal:V,conversion:function(e){return F({type:O.HYBRID_ACTION_EVENT.adOpenForm,payload:e})},telephone:function(e){var t=e.phoneNumber;return new Promise((function(e){try{window.location.href="tel://".concat(t),e({status:!0})}catch(t){e({status:!0})}}))},baseUrl:function(e){var t=e.url;return F({type:O.HYBRID_ACTION_EVENT.baseOpenURL,payload:{url:t}})}},H=Object.keys(M).reduce((function(e,t){return e[t]=t,e}),{});function F(){return O.dispatch.apply(O,arguments).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return E()({status:!0},e)})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return E()({status:!1},e)}))}function z(){return(z=T()(w.a.mark((function e(t){var a,n,r,c;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.shareUrl,n=t.shareDesc,r=t.picUrl,c=t.conversion,!t.isZmHandle){e.next=4;break}return A.show(t),e.abrupt("return",Promise.resolve({status:!0}));case 4:return e.abrupt("return",F({type:O.HYBRID_ACTION_EVENT.openWechatShare,payload:{deeplink:"weixin://",conversion:c,shareUrl:a,shareDesc:n,picUrl:r}}));case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function V(e){return B.apply(this,arguments)}function B(){return(B=T()(w.a.mark((function e(t){var a,n,r,c,o,i,s,l,d,u,m,p;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.deeplinkUrl,n=t.zhiContentInfo,r=void 0===n?{}:n,c=t.isZmHandle,a){e.next=3;break}return e.abrupt("return",Promise.resolve({status:!1}));case 3:if(!c){e.next=33;break}if(!(a.indexOf("zhihu2wechat://gotowechat?id=gh_bc33767b4df6")>-1)){e.next=29;break}if(!((o=decodeURIComponent(a).split("url="))[1].indexOf("https://mp.weixin.qq.com/")>-1)){e.next=23;break}if(!(/Safari/.test(navigator.userAgent)&&!/Chrome/.test(navigator.userAgent))){e.next=10;break}return e.abrupt("return",Promise.resolve({status:!1}));case 10:return e.next=12,D(o[1]);case 12:if(!(i=e.sent)||!i.scheme){e.next=20;break}return e.next=16,x(i.scheme);case 16:return s=e.sent,e.abrupt("return",s);case 20:return e.abrupt("return",Promise.resolve({status:!1}));case 21:e.next=27;break;case 23:return e.next=25,x(a);case 25:return l=e.sent,e.abrupt("return",l);case 27:e.next=33;break;case 29:return e.next=31,x(a);case 31:return d=e.sent,e.abrupt("return",Promise.resolve({status:d.status}));case 33:return u=Object(y.h)(),m=u.platform,p=Object(y.l)(a,E()({},r,{os:m,ts:parseInt(Date.now()/1e3)})),e.abrupt("return",F({type:O.HYBRID_ACTION_EVENT.adECommerceOpen,payload:E()({},t,{deeplinkUrl:p})}));case 36:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function Z(e){var t=e.url,a=e.adjson;if(e.isZmHandle)return Promise.resolve({status:!1});var n={adjson:JSON.stringify({ads:[{creatives:[{asset:{landing_url:t}}]}]})};return F({type:O.HYBRID_ACTION_EVENT.commonAd,payload:a?e:n})}function W(){return Promise.resolve({status:!1})}var Y=function e(){o()(this,e)};Y.execute=function(){var e=T()(w.a.mark((function e(t){var a,n,r,c,o,i,s,l,d,u,m,p;return w.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(a=t.isCanvas,n=t.cardType,r=t.isZmHandle,c=void 0!==r&&r,o=_(t),"pc"!==Object(y.h)().os){e.next=5;break}return S(o),e.abrupt("return");case 5:i=0,s=[{func:M[a?"conversion":n]},{func:Z}];case 7:if(!(i<s.length)){e.next=18;break}return l=s[i],d=l.func,u=void 0===d?W:d,m=l.payload,p=void 0===m?t:m,e.next=12,u(p);case 12:if(!e.sent.status){e.next=15;break}return e.abrupt("return");case 15:i++,e.next=7;break;case 18:S(o,c);case 19:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();var q=a(1151),G=k()({},"download","download"),X={CONTENT:"CONTENT",CANVAS:"CANVAS"},J=function(){function e(t){var a=this;o()(this,e),this._getMacroOptions=function(){var e=a.getRenderData(),t=e.xSuger,n=e.cardType,r=e.urlToken,c=void 0===r?"":r,o=e.aPageId,i=void 0===o?"":o,s=Object(y.h)().os;return{xSuger:t,cardType:n,aToken:c,aPageId:i,et:"".concat(s,"_").concat(G[n]||"commodity")}},this._getContentSign=function(){O.dispatch({type:O.HYBRID_ACTION_EVENT.adGetContentSign}).then((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.data,n=(t=void 0===t?{}:t).plugcb;if(n&&n.length){var r=Object(y.p)(n),c=r.cid,o=r.adid,i=r.zoneid,s=r.sid;a._mergeRenderData({zhiContentInfo:{cid:c,adid:o,zoneid:i,sid:s}})}}))},this._mergeRenderData=function(e){a.renderData=E()({},a.renderData,e)},this.setPosition=function(e){a.renderData=E()({},a.renderData,{position:e})},this.renderData={},this._calculateRenderData(t)}return s()(e,[{key:"setPropsData",value:function(e){this._calculateRenderData(e)}},{key:"preload",value:function(){if(!this._stopTracking()){var e=this.renderData,t=e.isCanvas,a=e.adjson;t&&O.dispatch({type:O.HYBRID_ACTION_EVENT.preloadAd,payload:{adjson:a}})}}},{key:"getConversionEv",value:function(e){var t=e.cardType,a=e.deeplinkUrl;return["normal","download"].includes(t)&&a||["wechat_minipro","wechat_service"].includes(t)?t:""}},{key:"handleClick",value:function(){var e,t,a,n,r=this.renderData,c=r.data,o=r.parentType,i=r.urlToken,s=r.os,l=r.downloadUrl,d=r.landingUrl,u=r.productName,m=r.deeplinkUrl,p=r.cardType,f=r.isZmHandle,v=r.zhiContentInfo,h=r.position;if(!this._stopTracking()){var C=E()({},O.getTrackMacroOptions(),this._getMacroOptions()),g=Object(y.q)({conversion:null!==(e=null===(t=this.renderData)||void 0===t?void 0:t.conversion)&&void 0!==e?e:[]},E()({},C,{cardType:this.getConversionEv({cardType:p,deeplinkUrl:m}),position:h})).conversion,k=Object(y.q)({downloadConversion:null!==(a=null===(n=this.renderData)||void 0===n?void 0:n.conversion)&&void 0!==a?a:[]},E()({},C,{cardType:""})).downloadConversion;try{Y.execute(E()({},c,{token:i,pagetype:o,urlToken:i,parentType:o,os:s,downloadUrl:l,landingUrl:d,productName:u,conversion:g,downloadConversion:k,isZmHandle:f,zhiContentInfo:v}))}catch(e){console.error(e.message)}}}},{key:"getRenderData",value:function(){return this.renderData}},{key:"getTrackInfo",value:function(){if(this._stopTracking())return{};var e=this.getRenderData(),t=e.trackUrl,a=e.ssid,n=e.id,r=a?"ssid=".concat(a):"";function c(e){var t=e.includes("?")?"&":"?";return"".concat(e).concat(t).concat(r)}return{zaClick:{id:5641},zaView:{id:5642},zaEnvBlock:"advertPluginCard",views:Object(y.d)(t,"view",[]).map(c),clicks:Object(y.d)(t,"click",[]).map(c),getMacroOptions:this._getMacroOptions,isReplacePosition:!0,setPosition:this.setPosition,id:n}}},{key:"_stopTracking",value:function(){return this.renderData.cmpStatus===q.a.ONLY_SHOW}},{key:"_calculateRenderData",value:function(e){var t=e.data,a=e.suger,n=e.urlToken,r=e.aPageId,c=void 0===r?"":r,o=e.parentType,i=e.cmpStatus,s=e.className,l=e.isZmHandle,d=e.pluginSourceFrom,u=void 0===d?X.CONTENT:d,m=e.ssid,p=t.url,f=t.price,v=t.picUrl,h=t.cardType,C=t.description,E=t.interactionLaunch,g=t.logo,k=t.trackUrl,b=t.productName,w=t.isCanvas,N=t.adjson,T=t.androidUrl,_=t.iosAppStoreUrl,S=t.validStatus,x=t.webExperiment,L=t.labelName,D=t.phoneNumber,I=t.pluginStyle,P=t.conversion,R=t.deeplinkUrl,j=t.appInfo,U=t.channelSource,A=t.id,M=Object(y.h)().os,H={ios:_,android:T}[M]||"";this._mergeRenderData({deeplinkUrl:R,conversion:P,showCartIcon:"去购买"===E,isHidden:w&&!N||-1===S,originData:e,showPrice:!!f,price:+parseFloat((f/100).toPrecision(12)),price2Decimal:O.formatPrice(f),picUrl:v,phoneNumber:D,cardType:h,description:C,interactionLaunch:E||"去购买",logo:g,trackUrl:k,productName:"".concat(b," 的推荐"),productNameNew:b,xSuger:a,aPageId:c,data:t,urlToken:n,parentType:o,isCanvas:w,adjson:N,downloadUrl:H,landingUrl:p,os:M,cmpStatus:i,pluginStyle:I,webExperiment:x,className:s||"",labelName:L,isZmHandle:l,pluginSourceFrom:u,appInfo:j,channelSource:U,ssid:m,id:A}),this._getContentSign()}}]),e}(),K=a(6),Q=a.n(K);function $(e){return h.a.createElement("svg",r()({xmlns:"http://www.w3.org/2000/svg",width:"27",height:"24",viewBox:"0 0 27 24"},e),h.a.createElement("path",{fill:"#0084FF",d:"M25.0589726,39.0133333 C25.4056402,39.0133333 25.7340622,39.0755556 26.0442385,39.2 C26.3544148,39.3244444 26.6280998,39.4977778 26.8652934,39.72 C27.1024871,39.9422222 27.2849437,40.2044444 27.4126634,40.5066667 C27.540383,40.8088889 27.6042428,41.1288889 27.6042428,41.4666667 C27.6042428,41.8044444 27.540383,42.1244444 27.4126634,42.4266667 C27.2849437,42.7288889 27.1024871,42.9911111 26.8652934,43.2133333 C26.6280998,43.4355556 26.3544148,43.6133333 26.0442385,43.7466667 C25.7340622,43.88 25.4056402,43.9466667 25.0589726,43.9466667 C24.6940593,43.9466667 24.3610759,43.88 24.0600224,43.7466667 C23.758969,43.6133333 23.4898454,43.4355556 23.2526518,43.2133333 C23.0154581,42.9911111 22.8330015,42.7288889 22.7052818,42.4266667 C22.5775622,42.1244444 22.5137023,41.8044444 22.5137023,41.4666667 C22.5137023,41.1288889 22.5775622,40.8088889 22.7052818,40.5066667 C22.8330015,40.2044444 23.0154581,39.9422222 23.2526518,39.72 C23.4898454,39.4977778 23.758969,39.3244444 24.0600224,39.2 C24.3610759,39.0755556 24.6940593,39.0133333 25.0589726,39.0133333 Z M36.4442675,39.0666667 C36.7909351,39.0666667 37.1239185,39.1288889 37.4432176,39.2533333 C37.7625167,39.3777778 38.0362017,39.5511111 38.2642725,39.7733333 C38.4923433,39.9955556 38.6748,40.2577778 38.8116425,40.56 C38.948485,40.8622222 39.0169062,41.1822222 39.0169062,41.52 C39.0169062,41.8577778 38.948485,42.1777778 38.8116425,42.48 C38.6748,42.7822222 38.4923433,43.0444444 38.2642725,43.2666667 C38.0362017,43.4888889 37.7625167,43.6666667 37.4432176,43.8 C37.1239185,43.9333333 36.7909351,44 36.4442675,44 C36.0975998,44 35.7691779,43.9333333 35.4590016,43.8 C35.1488253,43.6666667 34.8797017,43.4888889 34.6516309,43.2666667 C34.4235601,43.0444444 34.2411034,42.7822222 34.1042609,42.48 C33.9674185,42.1777778 33.8989972,41.8577778 33.8989972,41.52 C33.8989972,41.1822222 33.9674185,40.8622222 34.1042609,40.56 C34.2411034,40.2577778 34.4235601,39.9955556 34.6516309,39.7733333 C34.8797017,39.5511111 35.1488253,39.3777778 35.4590016,39.2533333 C35.7691779,39.1288889 36.0975998,39.0666667 36.4442675,39.0666667 Z M41.042175,23.92 C41.5530536,23.92 41.9498968,23.9866667 42.2327046,24.12 C42.5155124,24.2533333 42.7162147,24.4177778 42.8348116,24.6133333 C42.9534084,24.8088889 43.0081454,25.0177778 42.9990226,25.24 C42.9898997,25.4622222 42.9579698,25.6533333 42.9032328,25.8133333 C42.8484958,25.9733333 42.7344604,26.3022222 42.5611266,26.8 C42.3877928,27.2977778 42.1916519,27.8444444 41.9727039,28.44 C41.7537559,29.0355556 41.5393694,29.6266667 41.3295442,30.2133333 C41.1197191,30.8 40.9600695,31.2622222 40.8505955,31.6 C40.6134019,32.3111111 40.3123484,32.8044444 39.9474351,33.08 C39.5825218,33.3555556 39.135503,33.4933333 38.6063787,33.4933333 L37.6758498,33.4933333 L35.8968975,33.4933333 L33.5705752,33.4933333 L31.025305,33.4933333 L24.2379177,33.4933333 L24.6484451,35.8933333 L38.4421678,35.8933333 C39.3179597,35.8933333 39.7558556,36.2577778 39.7558556,36.9866667 C39.7558556,37.3422222 39.6691887,37.6488889 39.4958549,37.9066667 C39.3225211,38.1644444 38.9804149,38.2933333 38.4695363,38.2933333 L37.1558484,38.2933333 L34.6105781,38.2933333 L31.463201,38.2933333 L28.2610868,38.2933333 L25.633711,38.2933333 L24.1284437,38.2933333 C23.7635304,38.2933333 23.4579155,38.2133333 23.211599,38.0533333 C22.9652826,37.8933333 22.7600188,37.6844444 22.5958078,37.4266667 C22.4315969,37.1688889 22.2993158,36.8888889 22.1989646,36.5866667 C22.0986135,36.2844444 22.0210694,36 21.9663324,35.7333333 C21.9480867,35.6266667 21.8979112,35.3688889 21.8158057,34.96 C21.7337002,34.5511111 21.633349,34.04 21.5147522,33.4266667 C21.3961554,32.8133333 21.2638743,32.1288889 21.117909,31.3733333 C20.9719437,30.6177778 20.8259784,29.8577778 20.680013,29.0933333 C20.3333454,27.2977778 19.9410636,25.2977778 19.5031677,23.0933333 L17.4505304,23.0933333 C17.1768454,23.0933333 16.9487746,23.0266667 16.7663179,22.8933333 C16.5838613,22.76 16.4333345,22.6 16.3147377,22.4133333 C16.1961409,22.2266667 16.1140354,22.0266667 16.0684212,21.8133333 C16.0228071,21.6 16,21.4044444 16,21.2266667 C16,20.8711111 16.1231582,20.5777778 16.3694747,20.3466667 C16.6157912,20.1155556 16.9487746,20 17.3684249,20 L17.9705318,20 L18.5179017,20 L19.2021142,20 L20.1326431,20 C20.4975564,20 20.789487,20.0533333 21.008435,20.16 C21.227383,20.2666667 21.4007168,20.4 21.5284364,20.56 C21.6561561,20.72 21.7473844,20.8888889 21.8021214,21.0666667 C21.8568584,21.2444444 21.9024726,21.3955556 21.9389639,21.52 C21.9754552,21.6622222 22.0119466,21.8622222 22.0484379,22.12 C22.0849292,22.3777778 22.1214206,22.64 22.1579119,22.9066667 C22.2126489,23.2266667 22.2673859,23.5644444 22.3221229,23.92 L41.042175,23.92 Z",transform:"translate(-16 -20)"}))}var ee=a(1132);var te={invalid:function(e){var t=e.text;return h.a.createElement(h.a.Fragment,null,h.a.createElement("span",{className:"zh-advert-pligin-invalid-replace-sign"},h.a.createElement(ee.a,{width:17}),t),h.a.createElement("span",{className:"zh-advert-pligin-invalid-replace-placeholder"}," "))},audit:function(e){var t=e.text;return h.a.createElement(h.a.Fragment,null,h.a.createElement("span",{className:"zh-advert-plugin-audit-replace-sign"},h.a.createElement(ee.a,{width:17}),t),h.a.createElement("span",{className:"zh-advert-plugin-audit-replace-placeholder"}," "))}},ae=function(e){function t(){return o()(this,t),d()(this,m()(t).apply(this,arguments))}return f()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.children,a=e.signData,n=a.text,r=a.type,c=te[r];return c?h.a.createElement(c,{text:n}):t}}]),t}(v.Component);function ne(){return h.a.createElement(ee.a,{width:17,style:{flexShrink:0}})}ae.defaultProps={signData:{}};var re=ae,ce="ecommerce-ad",oe=function(e){var t=e.data,a=t.picUrl,n=t.logo,r=t.productName,c=t.description,o=t.price,i=t.interactionLaunch,s=t.showCartIcon,l=t.showPrice,d=t.className,u=t.data,m=e.onSetRef,p=e.onClick;return h.a.createElement("div",{className:"".concat(ce,"-container ").concat(d)},h.a.createElement("div",{className:ce,ref:m,onClick:p,"data-ad-type":"ecommerce-ad-card"},h.a.createElement("div",{className:"".concat(ce,"-img"),style:{backgroundImage:"url(".concat(a,")")}}),h.a.createElement("div",{className:Q()("".concat(ce,"-main"),{"ecommerce-ad-main-play":l})},h.a.createElement("div",{className:"".concat(ce,"-main-content")},h.a.createElement("header",{className:Q()("".concat(ce,"-main-content-title"),{"ecommerce-ad-main-content-title-play":l})},h.a.createElement("img",{alt:"",className:"".concat(ce,"-main-content-title-logo"),src:n,align:"middle"}),r),h.a.createElement("div",{className:Q()("".concat(ce,"-main-content-des"),{"ecommerce-ad-main-content-des-none":!l})},c),l&&h.a.createElement("div",{className:"".concat(ce,"-main-content-price")},"¥",o))),h.a.createElement(re,{signData:q.b(u)},h.a.createElement("div",{className:"".concat(ce,"-icon")},s&&h.a.createElement($,{className:"".concat(ce,"-main-content-purchase")}),i))))};function ie(e){return h.a.createElement("svg",r()({width:"24px",height:"24px",viewBox:"0 0 16 28"},e),h.a.createElement("g",{fill:"none",fillRule:"evenodd",transform:"translate(-16 -10)"},h.a.createElement("rect",{width:"48",height:"48"}),h.a.createElement("path",{d:"M16.5815824,37.3821495 C17.3536131,38.2059502 18.6110874,38.2059502 19.3860425,37.3821495 L31.4187837,25.4877594 C32.1937388,24.6639587 32.1937388,23.3329674 31.4187837,22.5091668 L19.3860425,10.6178505 C18.6110874,9.79404984 17.3565375,9.79404984 16.5815824,10.6178505 C15.8066273,11.4416511 15.8066273,12.7726424 16.578658,13.5964431 L26.6666667,24 L16.5815824,34.4035569 C15.8066273,35.2273576 15.8066273,36.5583489 16.5815824,37.3821495 Z"})))}var se="ecommerce-ad-arrow",le=function(e){var t=e.data,a=t.picUrl,n=t.description,r=t.data,c=t.productName,o=t.interactionLaunch,i=e.onClick,s=e.onSetRef,l=e.isBottomStyle;return h.a.createElement("div",{className:"ecommerce-ad-box"},h.a.createElement("div",{className:Q()(se,{"ecommerce-ad-bottom-style":l}),onClick:i,ref:s,"data-ad-type":"ecommerce-ad-card"},h.a.createElement("div",{className:"".concat(se,"-img"),style:{backgroundImage:"url(".concat(a,")")}}),h.a.createElement("div",{className:"".concat(se,"-main")},h.a.createElement("div",{className:"".concat(se,"-main-content")},l&&h.a.createElement("div",{className:"".concat(se,"-main-content-title")},c.slice(0,-3)),h.a.createElement("div",{className:"".concat(se,"-main-content-des")},h.a.createElement("span",null,n))),h.a.createElement(re,{signData:q.b(r)},l?h.a.createElement("div",{className:"".concat(se,"-button")},o):h.a.createElement("div",{className:"".concat(se,"-icon")},h.a.createElement(ie,{width:"8px",height:"14px"}))))))};function de(e){return h.a.createElement("svg",r()({width:"24px",height:"12px",viewBox:"0 0 40 20"},e),h.a.createElement("path",{d:"M27.7142857,3.5 L24.5714286,3.5 C23.7024286,3.5 23,4.226375 23,5.125 C23,6.022 23.7024286,6.75 24.5714286,6.75 L27.7142857,6.75 C29.4491429,6.75 30.8571429,8.206 30.8571429,10 C30.8571429,11.794 29.4491429,13.25 27.7142857,13.25 L24.5714286,13.25 C23.7024286,13.25 23,13.976375 23,14.875 C23,15.773625 23.7024286,16.5 24.5714286,16.5 L27.7142857,16.5 C31.1855714,16.5 34,13.589625 34,10 C34,6.410375 31.1855714,3.5 27.7142857,3.5 Z M17.4285714,13.25 L14.2857143,13.25 C12.5508571,13.25 11.1428571,11.794 11.1428571,10 C11.1428571,8.206 12.5508571,6.75 14.2857143,6.75 L17.4285714,6.75 C18.2975714,6.75 19,6.022 19,5.125 C19,4.226375 18.2975714,3.5 17.4285714,3.5 L14.2857143,3.5 C10.8144286,3.5 8,6.410375 8,10 C8,13.589625 10.8144286,16.5 14.2857143,16.5 L17.4285714,16.5 C18.2975714,16.5 19,15.773625 19,14.875 C19,13.976375 18.2975714,13.25 17.4285714,13.25 Z M16,9.75 C16,10.5795 16.745,11.25 17.6666667,11.25 L24.3333333,11.25 C25.255,11.25 26,10.5795 26,9.75 C26,8.9205 25.255,8.25 24.3333333,8.25 L17.6666667,8.25 C16.745,8.25 16,8.9205 16,9.75 Z",id:"形状",transform:"translate(21.000000, 10.000000) scale(1, -1) translate(-21.000000, -10.000000) "}))}function ue(e){return e.isFailurePlugin?h.a.createElement(ne,null):h.a.createElement(de,{width:"24px",height:"12px"})}var me=function(e){var t=e.data,a=t.description,n=t.data,r=e.onClick,c=e.onSetRef,o=q.c(n);return h.a.createElement("p",{className:"ecommerce-ad-link",onClick:r,ref:c,"data-ad-type":"ecommerce-ad-card"},h.a.createElement(ue,{isFailurePlugin:o}),a)},pe="ecommerce-ad-floatNode";function fe(e){var t=e.imgSrc,a=e.description,n=e.onClick,r=e.onSetRef,c=e.isExpand;return h.a.createElement("div",{className:Q()(pe,{"Float-node-fadeIn":!c}),onClick:n,ref:r},h.a.createElement("img",{className:"".concat(pe,"-img"),src:t}),h.a.createElement("span",{className:"".concat(pe,"-desc")},a))}function ve(){return h.a.createElement("svg",{width:"6",height:"9",viewBox:"0 0 6 9",fill:"none",xmlns:"http://www.w3.org/2000/svg"},h.a.createElement("path",{d:"M3.31467 4.5L0.745606 7.0685C0.418131 7.39598 0.418131 7.92692 0.745607 8.25439C1.07308 8.58187 1.60402 8.58187 1.9315 8.25439L5.09295 5.09295C5.25028 4.93572 5.33867 4.72242 5.33867 4.5C5.33867 4.27758 5.25028 4.06428 5.09295 3.90705L1.9315 0.745606C1.60402 0.418131 1.07308 0.418131 0.745607 0.745606C0.418131 1.07308 0.418131 1.60402 0.745606 1.9315L3.31467 4.5Z",fill:"#FF7955"}))}var he="ecommerce-ad-commodity",Ce="ecommerce-ad-commodity-box",Ee=function(e){var t=e.data,a=t.picUrl,n=t.showPrice,r=t.description,c=t.data,o=t.channelSource,i=t.price2Decimal,s=e.onClick,l=e.onSetRef;return h.a.createElement("div",{className:Q()("ecommerce-ad-box",Ce)},h.a.createElement("div",{className:"ecommerce-ad-commodity",onClick:s,ref:l,"data-ad-type":"ecommerce-ad-card"},h.a.createElement("div",{className:"".concat(he,"-img"),style:{backgroundImage:"url(".concat(a,")")}}),h.a.createElement("div",{className:"".concat(he,"-main")},h.a.createElement("div",{className:"".concat(he,"-main-content")},h.a.createElement("div",{className:"".concat(he,"-main-content-des")},h.a.createElement("span",null,r)),h.a.createElement("div",{className:"".concat(he,"-main-content-source")},o||"")),h.a.createElement("div",{className:"".concat(Ce,"-main-second")},h.a.createElement("div",{className:"".concat(Ce,"-main-second-price")},n&&"¥".concat(i)),h.a.createElement(re,{signData:q.b(c)},h.a.createElement("div",{className:"".concat(Ce,"-main-second-right")},"去购买",h.a.createElement("div",{className:"".concat(Ce,"-icon")},h.a.createElement(ve,{className:"rightArrow"}))))))))};function ge(e){return h.a.createElement("svg",r()({width:"24",height:"24",viewBox:"0 0 24 24"},e),h.a.createElement("path",{d:"M16.1917 20C14.4179 19.9167 12.0796 18.25 9.90253 15.5L9.09622 14.5C6.91918 11.6667 5.79035 9 6.03224 7.25C6.27413 6 8.04802 5 9.01559 5C9.49937 5 9.66064 5.25 9.74127 5.41667C10.3057 6.5 11.0314 8.33333 11.0314 8.91667V9.08333C10.8701 9.41667 10.6282 9.58333 10.3863 9.66667C9.98316 9.91667 9.8219 10 9.8219 10.4167C9.8219 10.5 9.90253 11 11.3539 12.9167L11.9989 13.6667C13.4503 15.4167 13.8534 15.6667 14.0147 15.6667C14.3372 15.75 14.4985 15.5833 14.7404 15.25C14.9017 15 15.1435 14.75 15.4661 14.75H15.6273C16.2724 14.9167 17.885 16 18.7719 16.75C18.9332 16.8333 19.0945 17.0833 18.9332 17.75C18.6107 18.5833 17.3206 20 16.1917 20Z",fill:"#0084FF"}))}var ke="ecommerce-ad-TelephoneCard";var ye=Object.freeze({NO_VERIFY:"NONE",ALL_VERIFY:"ALL",CHECK_AUTO:"WRITE"}),be=function(e){function t(e){var a;o()(this,t),(a=d()(this,m()(t).call(this,e))).handleChecked=function(){a.setState((function(e){return{checked:!e.checked}}))},a.handleSendCaptcha=function(){var e=a.props.data.originData.onSendVerify,t=a.state,n=t.phone;t.submitSuccess||(n?11===n.length?e?a.verifyPromise=e({phone:n}).then((function(){a.setState({message:"",captchaCountdown:60},(function(){var e=setInterval((function(){a.setState({captchaCountdown:a.state.captchaCountdown-1},(function(){a.state.captchaCountdown<=0&&(clearInterval(e),a.verifyPromise=null,a.setState({captchaCountdown:0}))}))}),1e3)}))})).catch((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.message,n=void 0===t?"请求错误,稍后再试":t;a.verifyPromise=null,a.setState({message:n})})):a.setState({message:"无法发送短信,刷新页面稍后再试"}):a.setState({message:"请输入正确的手机号"}):a.setState({message:"手机号不能为空"}))},a.handleChange=function(e){return function(t){var n,r,c=(null==t||null===(n=t.target)||void 0===n||null===(r=n.value)||void 0===r?void 0:r.trim())||"";["phone","captcha"].includes(e)&&(c=c.replace(/[^\d]/g,"")),c=c.substring(0,11),a.setState(k()({},e,c))}},a.handleSubmit=function(){var e=a.props,t=e.data.originData,n=e.dataModel,r=a.state,c=r.phone,o=r.name,i=r.captcha,s=r.submitSuccess;if(11===c.length){var l=t.onSubmit;a.submitPromise||s||(l?a.submitPromise=l({name:o,phone:c,verifyCode:i}).then((function(){var e,r;a.setState({submitSuccess:!0,message:""}),a.submitPromise=null,Object(y.q)({conversion:null!==(e=null==t||null===(r=t.data)||void 0===r?void 0:r.conversion)&&void 0!==e?e:[]},E()({},Object(O.getTrackMacroOptions)(),null==n?void 0:n._getMacroOptions(),{appendParams:"et=submit_success"})).conversion.forEach((function(e){return Object(y.t)(e)}))})).catch((function(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};console.log("e:",t),a.setState({message:null!==(e=null==t?void 0:t.message)&&void 0!==e?e:"提交失败"}),a.submitPromise=null})):a.setState({message:"无法提交,刷新页面稍后再试"}))}else a.setState({message:"请输入正确的手机号"})};var n=a.props.data.originData.phone,r=void 0===n?"":n;return r=r.substr(-11),a.state={submitSuccess:!1,message:"",checked:!0,captchaCountdown:0,phone:r},a}return f()(t,e),s()(t,[{key:"render",value:function(){var e,t,a=this.props,n=a.data.description,r=a.onSetRef,c=this.state,o=c.checked,i=c.captchaCountdown,s=c.phone,l=void 0===s?"":s,d=c.name,u=void 0===d?"":d,m=c.captcha,p=c.message,f=c.submitSuccess,v=o&&u&&l&&(!this.showVerify||m);return h.a.createElement("div",{className:"ecommerce-ad-box"},h.a.createElement("div",{className:"ecommerce-ad-form",ref:r,"data-ad-type":"ecommerce-ad-card"},h.a.createElement("div",{className:"".concat("ecommerce-ad-form","-title")},n),h.a.createElement("input",{className:"".concat("ecommerce-ad-form","-input"),type:"text",placeholder:"请输入姓名",onChange:this.handleChange("name"),disabled:f}),h.a.createElement("input",{className:"".concat("ecommerce-ad-form","-input"),type:"text",placeholder:"请输入手机号",onChange:this.handleChange("phone"),value:l,disabled:f}),this.showVerify&&h.a.createElement("div",{className:"".concat("ecommerce-ad-form","-verify")},h.a.createElement("input",{className:"".concat("ecommerce-ad-form","-input"),type:"text",placeholder:"请输入验证码",onChange:this.handleChange("captcha"),disabled:f}),h.a.createElement("span",{className:Q()("".concat("ecommerce-ad-form","-submit"),(e={},k()(e,"".concat("ecommerce-ad-form","-submit-active"),!i),k()(e,"".concat("ecommerce-ad-form","-submit-disabled"),Boolean(i)),e)),onClick:this.handleSendCaptcha},i?"".concat(i," 秒"):"发送验证码")),h.a.createElement("div",{className:"".concat("ecommerce-ad-form","-protocol"),onClick:this.handleChecked},h.a.createElement("input",{type:"checkbox",checked:o,readOnly:!0}),"点击提交即视为同意将您的信息分享给商家，商家将尽快与您联系"),Boolean(p.length)&&h.a.createElement("div",{className:"".concat("ecommerce-ad-form","-message")},p),h.a.createElement("div",{className:Q()("".concat("ecommerce-ad-form","-submit"),(t={},k()(t,"".concat("ecommerce-ad-form","-submit-active"),v),k()(t,"".concat("ecommerce-ad-form","-submit-disabled"),!v||f),t)),onClick:this.handleSubmit},f?"提交成功":"提交信息")))}},{key:"showVerify",get:function(){var e,t=this.props.data.originData,a=this.state.phone,n=t.data.verifyType;return n===ye.ALL_VERIFY||n===ye.CHECK_AUTO&&(null==t||null===(e=t.phone)||void 0===e?void 0:e.substr(-11))!==a}}]),t}(v.Component),we=a(1193),Ne=a.n(we),Te=a(2),Oe=a.n(Te),_e=(a(397),a(66)),Se=a.n(_e),xe=a(78),Le=a.n(xe),De=a(141);var Ie="CLICK",Pe="VIEW",Re="VIEWX",je="IMPRESSION",Ue={AD:"AD",PLUGIN:"PLUGIN"},Ae=a(22);var Me=function(e){for(var t=Array.from(document.querySelectorAll("[data-ad-type='ecommerce-ad-card'],a[data-draft-type='link-card'],div[data-draft-type='ad-link-card']")).filter((function(e){return"link-card"!==e.getAttribute("data-draft-type")||!!function(e){return e.includes("BIZ=ECOMMERCE")?e:e.includes(encodeURIComponent("BIZ=ECOMMERCE"))?decodeURIComponent(Se.a.parse(e.slice(e.indexOf("?")+1)).target||""):""}(e.href).includes("BIZ=ECOMMERCE")})),a=0;a<t.length;a++)if(t[a]==e)return a+1;return-1},He=h.a.createContext({});var Fe=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.clickTrackFunc,a=void 0===t?function(e){return Object(De.a)(e)}:t,n=e.trackFunc,r=void 0===n?function(e){return Promise.all(e.map((function(e){return Object(y.s)(e)})))}:n;return function(e,t){var n=t.actionType;return e=e.filter(Boolean),n===Ie?a(e,t):r(e,t)}},ze=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=d()(this,(e=m()(t)).call.apply(e,[this].concat(r)))).__setTrackRef=function(e){a.node=e},a.onTrackClick=function(e){a.sendClickTrack(e)},a.observers=[],a.touchStartTime=Date.now(),a.state={providerValue:{setTrackRef:a.__setTrackRef,onTrackClick:a.onTrackClick}},a.sendTrackArray=function(e,t){if(Array.isArray(e)&&0!==e.length){var n=t.actionType,r=a.props,c=r.sendTracks,o=r.onSendTracksBefore,i=r.onSendTracksAfter,s=e;if(s=o(s,t),!Array.isArray(s))throw new TypeError("必须返回打点请求的数组");i(c(s,{actionType:n}),t)}},a.replacePosition=function(e){return a.props.isReplacePosition?(a.position||(a.position=Me(a.node),a.props.setPosition(a.position)),Object(y.k)(e,{position:a.position})):e},a.getClickData=function(e){if(!e||!a.node)return"";var t=Object(De.b)(e,a.node),n=Object(De.c)(a.touchStartTime);return Se.a.stringify(E()({},t,n))},a.getClickUrls=function(e,t){if(!a.props.sendClickData)return a.replacePosition(e);var n=a.getClickData(t);return(a.replacePosition(e)||[]).map((function(e){return"".concat(e,"&").concat(n)}))},a.sendClickTrack=function(e){var t,n;(a.props.zaClick&&a.props.zaClick.id&&Object(De.f)("trackEvent",a.node,{id:a.props.zaClick.id,action:"Click"}),a.props.zaEnvBlock)&&(null===(t=a.zaRef)||void 0===t||null===(n=t.current)||void 0===n||n.trackEvent({eventType:"Click",action:"OpenUrl",elementLocation:{type:"Card"}}));a.sendTrackArray(a.getClickUrls(a.__trackUrls.clicks,e),{actionType:Ie,event:e})},a.calculateMacroOptions=function(){var e=Object(y.h)(),t=e.os,n=e.platform,r=Object(y.i)(),c=(navigator&&Object(y.e)(navigator.userAgent)).version;return a.__trackUrlMacroOption=E()({os:t,ua:navigator.userAgent,platform:n,isHybrid:r?"1":"0",version:c},a.props.getMacroOptions())},a.replaceUrlMacro=function(){var e=a.props,t=e.views,n=e.impressions,r=e.clicks,c=e.viewXs;a.__trackUrls=Object(y.q)({views:t,impressions:n,clicks:r,viewXs:c},a.calculateMacroOptions())},a.zaRef=h.a.createRef(),a}return f()(t,e),s()(t,[{key:"addListener",value:function(){var e=this;this.node&&!this.observers.length&&(this.sendTrackArray(this.__trackUrls.impressions,{actionType:je}),this.props.sendClickData&&this.node.addEventListener("touchstart",(function(){e.touchStartTime=Date.now()})),this.makeObservers([{threshold:[0],callback:function(){e.props.zaView&&e.props.zaView.id&&e.node&&Object(De.f)("cardShow",e.node,{id:e.props.zaView.id}),e.sendTrackArray(e.replacePosition(e.__trackUrls.views),{actionType:Pe})}},{threshold:[.3],callback:function(){e.sendTrackArray(e.replacePosition(e.__trackUrls.viewXs),{actionType:Re})}}]))}},{key:"makeObservers",value:function(e){var t=this;if(this.node)if(Array.isArray(e))e.forEach((function(e){t.makeObservers(e)}));else{var a=e.callback,n=function(e,t){var a=t.threshold;return new window.IntersectionObserver(e,{threshold:a})}((function(e){P()(e,1)[0].isIntersecting&&(a(),n.disconnect())}),{threshold:e.threshold});n.observe(this.node),this.observers.push(n)}}},{key:"componentDidMount",value:function(){this.replaceUrlMacro(),this.addListener()}},{key:"componentDidUpdate",value:function(){this.addListener()}},{key:"componentWillUnmount",value:function(){var e=this;this.observers.forEach((function(t){t.unobserve(e.node)})),this.observers=[]}},{key:"render",value:function(){var e,t=this,a=this.props,n=a.children,r=a.id;return h.a.Children.only(n),h.a.createElement(Ae.b,{content:{type:"Ad",id:"".concat(r)},block:"advertPluginCard"},h.a.createElement(Ae.d,{ref:this.zaRef}),h.a.createElement(Ae.e,{zaType:"Card"}),h.a.createElement(He.Provider,{value:this.state.providerValue},(e=n.type,Boolean(e)&&"string"==typeof e?h.a.cloneElement(n,{ref:function(e){!function(e,t){e&&("function"==typeof e?e(t):e.current=t)}(n.ref,e),t.node=e},onClick:function(e){t.sendClickTrack(e),"function"==typeof n.props.onClick&&n.props.onClick(e)}}):n)))}}]),t}(h.a.Component);ze.propTypes={type:Oe.a.oneOf(Object.keys(Ue)),views:Oe.a.array,viewXs:Oe.a.array,impressions:Oe.a.array,clicks:Oe.a.array,zaClick:Oe.a.shape({id:Oe.a.number}),zaView:Oe.a.shape({id:Oe.a.number}),getMacroOptions:Oe.a.func,onSendTracksBefore:Oe.a.func,onSendTracksAfter:Oe.a.func,sendTracks:Oe.a.func.isRequired},ze.defaultProps={views:[],viewXs:[],impressions:[],clicks:[],getMacroOptions:function(){return{}},onSendTracksBefore:function(e){return e},onSendTracksAfter:function(){},type:Ue.PLUGIN,sendTracks:Fe()},[{name:"PluginTrack",type:Ue.PLUGIN,sendTracks:Fe({clickTrackFunc:function(e){return Object(De.a)({trackMethod:De.e,tracks:e})},trackFunc:function(e){return Promise.all(e.map((function(e){return Object(De.e)(e)})))}})},{name:"ADTrack",type:Ue.AD}].forEach((function(e){var t=e.name,a=e.type,n=e.sendTracks;ze[t]=function(e){var t=e.children,c=Ne()(e,["children"]);return h.a.createElement(ze,r()({type:a,sendTracks:n},c),t)}}));var Ve=ze,Be=a(17);function Ze(e){return h.a.createElement("svg",r()({width:"32",height:"28",viewBox:"0 0 32 28"},e),h.a.createElement("g",{fill:"#0084FF",fillRule:"evenodd",transform:"translate(1.464 .212)"},h.a.createElement("path",{fillRule:"nonzero",d:"M26.7860999,22.6432186 C26.7860999,23.4221053 26.1860408,24.0379555 25.465587,24.0379555 L3.60661269,24.0379555 C2.88615896,24.0379555 2.28609987,23.4221053 2.28609987,22.6432186 C2.28609987,21.8147915 1.61452699,21.1432186 0.786099865,21.1432186 C-0.0423272597,21.1432186 -0.713900135,21.8147915 -0.713900135,22.6432186 C-0.713900135,25.0617699 1.21161398,27.0379555 3.60661269,27.0379555 L25.465587,27.0379555 C27.8605858,27.0379555 29.7860999,25.0617699 29.7860999,22.6432186 C29.7860999,21.8147915 29.114527,21.1432186 28.2860999,21.1432186 C27.4576727,21.1432186 26.7860999,21.8147915 26.7860999,22.6432186 Z"}),h.a.createElement("path",{d:"M6.98076923,7.75 L22.7965587,7.75 C23.6249858,7.75 24.2965587,8.42157288 24.2965587,9.25 L24.2965587,10 C24.2965587,10.8284271 23.6249858,11.5 22.7965587,11.5 L6.98076923,11.5 C6.15234211,11.5 5.48076923,10.8284271 5.48076923,10 L5.48076923,9.25 C5.48076923,8.42157288 6.15234211,7.75 6.98076923,7.75 Z",transform:"rotate(90 14.889 9.625)"}),h.a.createElement("path",{d:"M14.1740505,12.9298687 L21.8895438,12.7652365 C22.7177824,12.7475637 23.4035291,13.4046571 23.4212019,14.2328957 C23.4215138,14.247512 23.421612,14.2621321 23.4214964,14.2767514 L23.4173849,14.7969038 C23.4109719,15.6082292 22.7605975,16.2673977 21.9494313,16.2847062 L14.233938,16.4493384 C13.4056994,16.4670112 12.7199527,15.8099178 12.7022799,14.9816792 C12.701968,14.9670629 12.7018698,14.9524427 12.7019854,14.9378235 L12.7060968,14.4176711 C12.7125099,13.6063457 13.3628843,12.9471772 14.1740505,12.9298687 Z",transform:"rotate(135 18.062 14.607)"}),h.a.createElement("path",{d:"M7.82789662,12.9298687 L15.5433899,12.7652365 C16.3716285,12.7475637 17.0573752,13.4046571 17.0750481,14.2328957 C17.07536,14.247512 17.0754581,14.2621321 17.0753426,14.2767514 L17.0712311,14.7969038 C17.0648181,15.6082292 16.4144436,16.2673977 15.6032775,16.2847062 L7.88778416,16.4493384 C7.05954556,16.4670112 6.37379885,15.8099178 6.35612601,14.9816792 C6.35581413,14.9670629 6.35571595,14.9524427 6.35583151,14.9378235 L6.35994299,14.4176711 C6.36635601,13.6063457 7.01673045,12.9471772 7.82789662,12.9298687 Z",transform:"scale(1 -1) rotate(-45 -23.55 0)"})))}var We,Ye=a(585),qe="ecommerce-ad-download-style",Ge="ecommerce-ad-download-warning";function Xe(e,t){e.stopPropagation(),e.preventDefault(),Y.execute({url:t,cardType:"baseUrl"})}var Je={card:le,text:me,ecard:Ee,standard:oe,download:function(e){var t=e.data,a=t.picUrl,n=t.description,r=t.productNameNew,c=t.data,o=t.pluginSourceFrom,i=t.appInfo,s=e.onClick,l=e.onSetRef,d="string"==typeof i?JSON.parse(i):i,u=Object(Be.camelizeKeys)(d)||{},m=u.name,p=u.appVersion,f=u.developer,v=u.appPermissionsUrl,C=u.appPrivacyUrl,E=function(e){var t=e.iosScore,a=void 0===t?0:t,n=e.androidScore,r=void 0===n?0:n;return"android"===Object(y.h)().os?r:a}(c),g=X.CANVAS===o?[function(){},s]:[s,function(){}],k=P()(g,2),b=k[0],w=k[1],N=m&&p&&f&&v&&C,T=h.a.createElement("span",{className:"".concat(Ge,"-right")},"|");return h.a.createElement("div",{className:"ecommerce-ad-box"},h.a.createElement("div",{className:qe,onClick:b,ref:l,"data-ad-type":"ecommerce-ad-card"},h.a.createElement("div",{className:"".concat(qe,"-img"),style:{backgroundImage:"url(".concat(a,")")}}),h.a.createElement("div",{className:"".concat(qe,"-main")},h.a.createElement("div",{className:"".concat(qe,"-main-content")},h.a.createElement("div",{className:"".concat(qe,"-main-content-des")},h.a.createElement("span",null,r),h.a.createElement("span",null,n)),h.a.createElement("div",{className:"".concat(qe,E>0?"-main-content-bottom":"-main-content-bottom-noScore")},E>0&&h.a.createElement(Ye.a,{score:E,showScore:!0}),h.a.createElement(re,{signData:q.b(c)},h.a.createElement("div",{className:"".concat(qe,"-icon-blue"),onClick:w},h.a.createElement(Ze,{width:"15px",height:"15px"}),h.a.createElement("span",null,"下载"))))))),N&&"android"===Object(y.h)().os?h.a.createElement("div",{className:Ge},h.a.createElement("div",{className:"".concat(Ge,"-appDes")},h.a.createElement("span",null,"应用名称: ",m),T,h.a.createElement("span",null,"版本号: ",p),T,h.a.createElement("span",null,"开发者: ",f),T,h.a.createElement("a",{onClick:function(e){return Xe(e,C)},className:"".concat(Ge,"-right")},"隐私政策"),T,h.a.createElement("a",{onClick:function(e){return Xe(e,v)}},"应用权限"))):"")},telephone:function(e){var t=e.data,a=t.picUrl,n=t.description,r=t.data,c=e.onClick,o=e.onSetRef,i=r.brandName,s=void 0===i?"":i;return h.a.createElement("div",{className:"ecommerce-ad-box"},h.a.createElement("div",{className:ke,onClick:c,ref:o,"data-ad-type":"ecommerce-ad-card"},h.a.createElement("div",{className:"".concat(ke,"-img"),style:{backgroundImage:"url(".concat(a,")")}}),h.a.createElement("div",{className:"".concat(ke,"-main")},h.a.createElement("div",{className:"".concat(ke,"-main-content")},h.a.createElement("div",{className:"".concat(ke,"-main-content-title")},s),h.a.createElement("div",{className:"".concat(ke,"-main-content-des")},n)),h.a.createElement(re,{showInvalidSign:q.b(r)},h.a.createElement("div",{className:"".concat(ke,"-icon")},h.a.createElement(ge,null))))))},form:be},Ke=Object.keys(Je).reduce((function(e,t){return e[t]=t,e}),{});function Qe(e){var t=e.data,a=t.picUrl,n=t.interactionLaunch,r=t.originData,c=e.onClick,o=e.onSetRef,i=r.isExpand;return h.a.createElement(fe,{isExpand:i,imgSrc:a,description:n,onClick:c,onSetRef:o})}var $e,et=Object.freeze({IN_TEXT:"0",BOTTOM:"1",FLOAT:"2"}),tt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.forwardRef,n=void 0!==a&&a;function c(t){return h.a.createElement(He.Consumer,null,(function(a){return h.a.createElement(e,r()({ref:t.forwardRef?t.forwardRef:null},a,t))}))}return Le()(c,e),n&&h.a.forwardRef((function(e,t){return h.a.createElement(c,r()({},e,{forwardedRef:t}))})),c}(We=function(e){function t(){var e,a;o()(this,t);for(var n=arguments.length,r=new Array(n),c=0;c<n;c++)r[c]=arguments[c];return(a=d()(this,(e=m()(t)).call.apply(e,[this].concat(r)))).handleClick=function(e){a.props.onTrackClick(e),a.props.onClick(e)},a}return f()(t,e),s()(t,[{key:"render",value:function(){var e=this.props,t=e.data,a=t.pluginStyle,n=t.originData,c=e.setTrackRef,o=n.displayMode,i=Je[a]||oe,s=o===et.BOTTOM;return o===et.FLOAT?h.a.createElement(Qe,r()({},this.props,{onSetRef:c,onClick:this.handleClick})):h.a.createElement(i,r()({},this.props,{isBottomStyle:s,onSetRef:c,onClick:this.handleClick}))}}]),t}(h.a.Component))||We,at=a(257),nt=Object(at.b)($e=function(e){function t(e){var a;return o()(this,t),(a=d()(this,m()(t).call(this,e))).onClick=function(e){e.stopPropagation(),e.preventDefault(),a.dataModel.handleClick()},a.dataModel=new J(e),a}return f()(t,e),s()(t,[{key:"componentDidMount",value:function(){this.dataModel.preload()}},{key:"shouldComponentUpdate",value:function(e){return this.dataModel.setPropsData(e),!0}},{key:"render",value:function(){var e=this.dataModel.getRenderData();return e.isHidden?h.a.createElement("div",{className:"ecommerce-ad-null","data-ad-type":"ecommerce-ad-card"}):h.a.createElement(Ve.PluginTrack,r()({},this.dataModel.getTrackInfo(),{sendClickData:!0}),h.a.createElement(tt,{data:e,dataModel:this.dataModel,onClick:this.onClick}))}}]),t}(v.Component))||$e},1403:function(e,t,a){e.exports=a(115)(201)},1429:function(e,t,a){"use strict";a.r(t);var n=a(31),r=a.n(n),c=a(1),o=a.n(c),i=a(66),s=a.n(i),l=a(224),d=a(102),u=a(1193),m=a.n(u),p=a(196),f=a.n(p),v=a(330),h=a.n(v),C=a(49),E=a.n(C),g=a(116),k=a.n(g),y=a(1403),b=a.n(y),w=a(497),N=a.n(w),T=function(e){if(204===e.status)return!1;if("0"===e.headers.get("content-length"))return!1;var t=e.headers.get("content-type");return t&&-1!==t.indexOf("application/json")},O=function(e){var t=e.status;return t>=200&&t<300},_=function(){var e=k()(E.a.mark((function e(t,a){var n,r;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t>=400)){e.next=5;break}throw n=a.error,r=(n=void 0===n?{}:n).message,new Error(r||"服务器错误");case 5:return e.abrupt("return",a);case 6:case"end":return e.stop()}}),e)})));return function(t,a){return e.apply(this,arguments)}}(),S=function(e,t){if("object"===h()(t.query)){var a=N.a.parse(e,!0),n=b.a.stringify(f()({},a.query,t.query));return"".concat(e,"?").concat(n)}return e},x=function(e){var t=e.body,a=void 0===t?{}:t,n=e.headers,r=void 0===n?{}:n,c=m()(e,["body","headers"]);return f()({},c,{body:JSON.stringify(a),headers:f()({},r,{"content-type":"application/json","X-Requested-With":"Fetch"})})};function L(){return(L=k()(E.a.mark((function e(t){var a,n,r,c,o,i,s=arguments;return E.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=s.length>1&&void 0!==s[1]?s[1]:{},e.prev=1,n=x(a),r=S(t,a),e.next=6,fetch(r,n);case 6:if(c=e.sent,!T(c)){e.next=13;break}return e.next=10,c.json();case 10:e.t0=e.sent,e.next=16;break;case 13:return e.next=15,c.text();case 15:e.t0=e.sent;case 16:if(o=e.t0,!O(c)){e.next=21;break}e.t1=o,e.next=24;break;case 21:return e.next=23,_(c.status,o);case 23:e.t1=e.sent;case 24:return e.t2=e.t1,i={data:e.t2},e.abrupt("return",i);case 29:return e.prev=29,e.t3=e.catch(1),e.abrupt("return",Promise.reject(e.t3));case 32:case"end":return e.stop()}}),e,null,[[1,29]])})))).apply(this,arguments)}function D(e,t){return new Promise((function(a,n){Object(l.b)(d.HYBRID_ACTION_EVENT.fetchAdLinkCardInfo,e).then((function(e){a(e.data)})).catch((function(){var r=t?s.a.stringify(t):"",c="https://www.zhihu.com/api/v4/commercial/ecommerce?".concat(r),o=window.location.host,i=o.endsWith("dev")?"dev":"com",l=/--box-(\d+)--/g.exec(o);l&&(c="https://bidding-ecommerce-web--box-".concat(l[1],"--www-zhihu-com.zpres.zhihu.").concat(i,"/api/v4/commercial/ecommerce?").concat(r)),function(e){return L.apply(this,arguments)}(c,{body:e,method:"POST",credentials:"include"}).then((function(e){a(e.data)})).catch((function(e){console.error("FetchData Request Error ",e),n(e)}))}))}))}var I=a(1194),P=a(21),R=a.n(P),j=a(23),U=a.n(j),A=a(67),M=a(141),H=function(){function e(t){var a=this;R()(this,e),this.setPropsData=function(e){a.calculateRenderData(e)},this.updateTracks=function(){var e=a.getRenderData(),t=e.xSuger,n=e.trackUrl,r=e.cardType,c={_dk:"".concat(Date.now()*Math.random())},o=Object(A.h)().os,i=Object(A.q)(n,{os:o,ua:navigator.userAgent,et:"".concat(o,"_commodity"),xSuger:t,cardType:r,creativeId:Object(A.f)(),appendParams:s.a.stringify(c)}),l=Object(A.d)(i,"view",[]),d=Object(A.d)(i,"click",[]);a._mergeRenderData({viewTrackUrls:l,clickTrackUrls:d})},this._mergeRenderData=function(e){a.renderData=f()({},a.renderData,e)},this.renderData={},this.calculateRenderData(t)}return U()(e,[{key:"trackViewUrl",value:function(e){var t=e.node,a=this.renderData,n=a.viewTrackUrls,r=a.data,c=r.isCanvas,o=r.adjson;Object(A.o)(t,(function(){try{n.forEach((function(e){return Object(A.s)(e)})),Object(M.f)("cardShow",t,{id:5642})}catch(e){console.error(e.message)}})),c&&Object(l.a)({adjson:o},"ad/preload")}},{key:"calculateRenderData",value:function(e){var t=e.data,a=e.suger,n=t.price,r=t.picUrl,c=t.cardType,o=t.description,i=t.interactionLaunch,s=t.logo,l=t.trackUrl,d=t.productName,u=t.webExperiment,m=(u=void 0===u?{}:u).awAdPluginStyle;this._mergeRenderData({price:n,picUrl:r,cardType:c,description:o,interactionLaunch:i,logo:s,trackUrl:l,productName:d,awAdPluginStyle:m,xSuger:a,data:t})}},{key:"getRenderData",value:function(){return this.renderData}}]),e}(),F=a(257),z=a(1151);var V=Object(F.b)((function(e){var t=e.data,a=e.parentType,n=e.urlToken,r=e.suger,i=e.isPreview,s=e.isZmHandle,l=e.ssid,d=1===t.implantType,u=o.a.createRef();if(Object(c.useEffect)((function(){if(d){var t=new H(e);t.updateTracks(),t.trackViewUrl({node:u.current})}}),[t,u,d,e]),"inValidate"===t.status)return null;var m="";return i&&(m=z.a.ONLY_SHOW),o.a.createElement(o.a.Fragment,null,!!t.content&&o.a.createElement("p",{className:"ecommerce-ad-implant",ref:u},t.content),!d&&o.a.createElement(I.default,{ssid:l,data:t,parentType:a,urlToken:n,suger:r,cmpStatus:m,isZmHandle:s}))})),B=a(36),Z=a.n(B),W=Object(F.b)((function(e){var t=e.data,a=e.isEditor,n=e.isPreview,r="",c=z.c(t);return(a||n||c)&&(r=z.a.ONLY_SHOW),c?o.a.createElement("div",{className:"eCommerce-ad-failure"},o.a.createElement(I.default,Z()({},e,{cmpStatus:r}))):o.a.createElement(I.default,Z()({},e,{cmpStatus:r}))})),Y=Object(F.b)((function(e){var t=e.isEditor,a=e.isPreview,n="";return(t||a)&&(n=z.a.ONLY_SHOW),o.a.createElement(I.default,Z()({},e,{cmpStatus:n}))})),q=new(function(){function e(){R()(this,e),this.events=Object.create(null),this.response=Object.create(null)}return U()(e,[{key:"clearData",value:function(){this.response={}}},{key:"request",value:function(e,t,a,n){var r=this;return this.response[e]?Promise.resolve(this.response[e]):new Promise((function(c,o){Array.isArray(r.events[e])||(r.events[e]=[],t(a,n).then((function(t){r.response[e]=t,r.emit(e,t,1)})).catch((function(t){r.emit(e,t,0)}))),r.on(e,(function(e){1===e.status?c(e.data):o(e.data)}))}))}},{key:"on",value:function(e,t){this.events[e].push(t)}},{key:"emit",value:function(e,t,a){this.events[e].forEach((function(e){e({data:t,status:a})})),this.events[e]=null}}]),e}()),G=["ZhiTask","Plugin"],X={type1:V,type2:V,type3:W,type4:Y};t.default=function(e){var t=e.id,a=e.parentType,n=e.urlToken,i=e.suger,s=e.data,l=e.isEditor,d=e.isPreview,u=e.isZmHandle,m=e.ssid,p=Object(c.useState)(s),f=r()(p,2),v=f[0],h=f[1],C=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return G.includes(e.split("_")[0])}(t);if(Object(c.useEffect)((function(){if(!s&&(!l||C)){var e=Object(A.h)().os,r={card_ids:t,type:a,url_token:n,os:e,isEditor:l};q.clearData(),q.request(t,D,r,m?{ssid:m}:null).then((function(e){var t=Array.isArray(e.data)&&e.data.length>0?e.data[0]:"fail";h(t)})).catch((function(e){h("fail"),console.error("Once Request Error ",e)}))}}),[s,t,l,C,a,m,n]),l&&!C)return o.a.createElement("div",{className:"ecommerce-ad-editor"},"这里将展示商业合作的插件/内容信息");if(!v||"fail"===v)return o.a.createElement("div",{className:"ecommerce-ad-null","data-ad-type":"ecommerce-ad-card"});var E=l?"ecommerce-ad-nopadding":"",g=X["type".concat(v.commercialType)];return g?o.a.createElement(g,{data:v,parentType:a,urlToken:n,suger:i,className:E,isPreview:d,isEditor:l,isZmHandle:u,ssid:m}):o.a.createElement("div",{className:"ecommerce-ad-null","data-ad-type":"ecommerce-ad-card"})}}}]);
//# sourceMappingURL=column.EcommerceAdCard.c1fab23e54d6781a48ed.js.map